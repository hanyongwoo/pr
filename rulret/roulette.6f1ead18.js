Array.prototype.remove=function(e){return this.some(function(t,n,i){return t===e&&(i.splice(n,1),!0)}),this},Array.prototype.removeAll=function(e){return this.forEach(function(t,n,i){t===e&&i.splice(n,1)}),this};var e,t,n,i,r,o=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b"];e=Math.floor(Math.random()*o.length),t=o[e],o.remove(t),window.getColor=function(n){return 0==n?t:o[Math.floor(e+4*n)%o.length]};var a="#ffffff";function l(e){return e*Math.PI/180}function c(){var e=[],t=0,n=0;$("li.item").each(function(e,t){var i=$(t);if(i.find(".item-title").text())i.removeClass("empty");else{i.addClass("empty");return}var r=parseFloat(i.find(".item-weight").attr("data-weight"))||0;n+=r}),$("li.item:not(.empty)").each(function(i,r){var o=$(r),a=o.find(".item-title").text();if(a){var l=(parseFloat(o.find(".item-weight").attr("data-weight"))||0)/n;o.attr("data-chance",(100*l).toFixed(2));var c=360*l;t+=c;var f=getColor(i);e.push({name:a,angle:c,angleSum:t,color:f}),o.css("background","linear-gradient(to right, "+f+" 11%, rgba(0, 0, 0, 0) 0%)")}}),R.Items=e,R.dirty=!0}function f(){var e=[];$("li").each(function(){var t=$(this),n=t.find(".item-title"),i=n.text().trim();n.text(i),i||e.push(t)}),0===e.length?createItem():e.length>1&&(e.pop(),e.forEach(function(e){e.remove()})),function(){var e=$("#addCheckList").find(".item-checkbox"),t=$("li.item").not(".empty"),n=e.length,i=t.length;if(n>i)for(var r=n-1;r>=i;r--)e.eq(r).remove();else n<i&&t.each(function(e){if(e>=n){var t=$(this).find(".item-title").text();$("#addCheckList").append('<div class="item-checkbox"><input type="checkbox" class="single-checkbox" />'+t+"</div>")}})}()}function u(e){e?($("[contenteditable]").attr("contenteditable",!1),$("ul").addClass("lock")):($("[contenteditable]").attr("contenteditable",!0),$("ul").removeClass("lock"))}$(document).ready(function(){var e=$("li.item").clone();window.createItem=function(){$("ul").append(e.clone())}}),$(document).on("change","#addCheckList .single-checkbox",function(){$(this).prop("checked")&&$("#addCheckList .single-checkbox").not(this).prop("checked",!1)}),$(document).on("blur",".item-title",function(e){f(),c()}),$(document).on("keyup",".item-title",function(e){c()}),$(document).on("change",".single-checkbox",function(){$(this).prop("checked")&&$(".single-checkbox").not(this).prop("checked",!1)}),$(document).on("click","li.item",function(e){$(e.currentTarget).find(".item-title").focus()}),$(document).on("click",".item-weight-add, .item-weight-sub",function(e){e.stopPropagation();var t=$(e.currentTarget),n=t.is(".item-weight-add")?1:t.is(".item-weight-sub")?-1:0,i=t.focus().siblings(".item-weight"),r=e.ctrlKey&&!e.shiftKey&&e.altKey?1e3:e.ctrlKey||e.shiftKey||!e.altKey?!e.ctrlKey||e.shiftKey||e.altKey?1:10:100,o=Math.floor(Math.max(1,Math.min(9999,(parseInt(i.attr("data-weight"))||1)+n*r)));i.attr("data-weight",o),c()}),$(document).on("keydown",function(e){var t=$(e.target);"Enter"===e.key?(e.preventDefault(),f(),t.is(".item-title")&&t.blur().closest("li").next("li").find(".item-title").focus(),t.is("[contenteditable]")&&t.blur()):"Escape"===e.key&&t.is("[contenteditable]")&&t.blur()}),$(document).ready(function(){!function(){var e={dirty:!0,rotation:0,$button:$("#roll")};function t(i){if(e.deltaTime=i-(e.lastTimestamp||i),e.stopping&&Date.now()-e.stopping>15e3&&(e.angularVelocity=0,delete e.stopping),e.angularVelocity>0&&(e.rotation+=e.angularVelocity*(i/999),e.angularVelocity*=.99),e.angularVelocity){for(e.rotation+=e.angularVelocity*(e.deltaTime/1e3);e.rotation<0;)e.rotation+=360;for(;e.rotation>=360;)e.rotation-=360;null!==e.targetAngle&&e.angularVelocity<180&&1>Math.abs(e.rotation-e.targetAngle)&&(e.angularVelocity=0)}e.prevRotation!=e.rotation&&(e.dirty=!0),requestAnimationFrame(t),e.prevRotation=e.rotation,e.dirty&&(e.dirty=!1,e.buffer.fillStyle=a,e.buffer.fillRect(0,0,e.size.width,e.size.height),e.FPS&&(e.buffer.font=window.font,e.buffer.fillStyle=window.line_color,e.buffer.fillText(e.FPS+"FPS",50,e.center.y-window.radius-7)),e.buffer.shadowBlur=15,e.buffer.shadowColor="black",n({x:e.center.x,y:e.center.y+15+5,radius:window.radius-5,rotation:0,angle:360,color:a},""),e.buffer.shadowBlur=0,n({x:e.center.x,y:e.center.y+15,radius:window.radius,rotation:0,angle:360,color:a},""),e.current=null,e.Items&&e.Items.length>0?(e.lastAngle=0,e.Items.forEach(function(t){for(e.currentAngle=360-e.rotation;e.currentAngle<0;)e.currentAngle+=360;for(;e.currentAngle>=360;)e.currentAngle-=360;n({x:e.center.x,y:e.center.y+15,radius:window.radius,rotation:e.rotation+e.lastAngle,angle:t.angle,color:t.color},null,!0),e.lastAngle+=t.angle}),e.lastAngle=0,e.Items.forEach(function(t){for(e.currentAngle=360-e.rotation;e.currentAngle<0;)e.currentAngle+=360;for(;e.currentAngle>=360;)e.currentAngle-=360;t.angleSum-t.angle<=e.currentAngle&&e.currentAngle<=t.angleSum&&(e.current=t.name,e.currentColor=t.color),n({x:e.center.x,y:e.center.y+15,radius:window.radius,rotation:e.rotation+e.lastAngle,angle:t.angle,color:t.color},t.name,!0),e.lastAngle+=t.angle})):(n({x:e.center.x,y:e.center.y+15,radius:window.radius,rotation:e.rotation-45,angle:180,color:getColor(0)},"돌려돌려"),n({x:e.center.x,y:e.center.y+15,radius:window.radius,rotation:e.rotation-45+180,angle:180,color:getColor(1)},"돌림판")),e.buffer.beginPath(),e.buffer.moveTo(e.size.width/2,e.center.y-window.radius+20),e.buffer.lineTo(e.size.width/2-5,e.center.y-window.radius+5),e.buffer.lineTo(e.size.width/2-5,e.center.y-window.radius+0),e.buffer.lineTo(e.size.width/2+5,e.center.y-window.radius+0),e.buffer.lineTo(e.size.width/2+5,e.center.y-window.radius+5),e.buffer.closePath(),e.buffer.fillStyle=window.pinColor,e.buffer.fill(),e.buffer.stroke(),e.current&&(e.buffer.font=window.font,e.currentColor&&(e.buffer.strokeStyle=window.line_color,e.buffer.lineWidth=5,e.buffer.strokeText(e.current,e.size.width/2,e.center.y-window.radius-7)),e.buffer.fillStyle=e.currentColor||window.line_color,e.buffer.fillText(e.current,e.size.width/2,e.center.y-window.radius-7)),e.ctx.drawImage(e.bufferCanvas,0,0)),e.lastTimestamp=i}function n(t,n,i){i&&(!i||n)||(e.buffer.save(),e.buffer.translate(t.x,t.y),e.buffer.rotate(l(t.rotation-90)),e.buffer.beginPath(),e.buffer.moveTo(0,0),e.buffer.arc(0,0,t.radius,0,l(t.angle)),e.buffer.closePath(),e.buffer.fillStyle=t.color,e.buffer.fill(),e.buffer.beginPath(),e.buffer.arc(0,0,t.radius,0,l(t.angle)),e.buffer.strokeStyle=window.line_color,e.buffer.lineWidth=3,e.buffer.stroke(),e.buffer.restore()),(!i||i&&n)&&(e.buffer.save(),e.buffer.translate(t.x,t.y),e.buffer.rotate(l(t.rotation-90+t.angle/2)),e.buffer.beginPath(),e.buffer.moveTo(0,0),e.buffer.font=window.font2,e.buffer.strokeStyle="#37474f",e.buffer.lineWidth=5,e.buffer.strokeText(n,t.radius/2,8),e.buffer.fillStyle="white",e.buffer.fillText(n,t.radius/2,8),e.buffer.restore())}window.R=e,e.Launch=function(t){if(e.angularVelocity=2160,e.angularDamping=10,t){let n=e.Items.find(e=>e.name===t);if(n){e.Items.indexOf(n);let t=n.angleSum-n.angle/2;e.targetAngle=(360-t)%360,e.rotation=360*Math.random()}}else e.targetAngle=null},e.Stop=function(){clearTimeout(r),r=setTimeout(function(){var e=null;$(".item-checkbox").each(function(){var t=$(this),n=t[0].textContent.trim();t[0].firstChild.checked&&n&&(e=n)});var t=$("#roll");setTimeout(function(){var t=e||"체크된 이름이 없습니다.";$result.removeClass("out").text(t).show().addClass("play")},1500),t.fadeIn(600,function(){u(!1)})},1500)},function(){try{$(document.body).css("background",a),e.canvas=document.querySelector("canvas"),e.ctx=e.canvas.getContext("2d",!0),e.size={width:e.canvas.width,height:e.canvas.height},e.center={x:e.size.width/2,y:e.size.height/2},window.radius=Math.min(.45*Math.min(e.size.width,e.size.height),e.size.height/2-40),e.bufferCanvas=document.createElement("canvas"),e.bufferCanvas.width=e.size.width,e.bufferCanvas.height=e.size.height,e.buffer=e.bufferCanvas.getContext("2d",!0),e.buffer.textAlign="center",requestAnimationFrame(t)}catch(e){console.log(e)}}()}();var e=$("#roll");R.onStop=function(){$(".item-checkbox").each(function(){var e=$(this);e[0].textContent.trim(),e[0].firstChild.checked}),clearTimeout(r),r=setTimeout(function(){e.fadeIn(600,function(){u(!1),$result.hide()})},1500)}}),$(document).on("click","#roll",function(e){if(R.isRolling)R.isRolling=!1,R.Stop(),$(e.currentTarget).focus().removeClass("active").hide();else{R.isRolling=!0;var t=null;$(".item-checkbox").each(function(){var e=$(this),n=e[0].textContent.trim();e[0].firstChild.checked&&n&&(t=n)}),R.Launch(t),$(e.currentTarget).focus().addClass("active"),u(!0)}}),$(document).on("click",".item-delete",function(e){$(e.currentTarget).closest("li").remove(),c(),f()}),$(document).on("keydown","h1[contenteditable]",function(e){"Enter"===e.key&&e.preventDefault()}),$(document).on("click","#roll",function(e){var t=null;$(".item-checkbox").each(function(){var e=$(this),n=e[0].textContent.trim();e[0].firstChild.checked&&n&&(t=n)}),R.isRolling?(R.isRolling=!1,R.Launch(t),R.Stop(),$(e.currentTarget).focus().removeClass("active").hide()):(R.isRolling=!0,R.Launch(t),$(e.currentTarget).focus().addClass("active"),u(!0))}),n=$("#button-tooltip"),i=$("ul"),$(document).on("mouseenter mousemove",".item-weight-sub, .item-weight-add",function(e){var t;t=i.offset(),t.top-=100,t.left+=100,n.offset(t),n.show()}).on("mouseleave",".item-weight-sub, .item-weight-add",function(e){n.hide()});
//# sourceMappingURL=roulette.6f1ead18.js.map
